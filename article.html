<!DOCTYPE html>
<meta charset="utf-8">
<script src="https://distill.pub/template.v1.js"></script>
<script src="https://d3js.org/d3.v5.js"></script>
<script src="buildFigure.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

    <script>    
    var dataW = {Nx: 60, Ny: 24, Nx11: 54, Nx12: 6, Nx21: 42, Nx22: 18, Ny1: 8, Ny2: 16};
                        var dataM = {Nx: 60, Ny: 24, Nx11: 51, Nx12: 9, Nx21: 39, Nx22: 21, Ny1: 20, Ny2: 4};
                        var scale = 8
                        var paddingLeft = 50
    </script>

<script type="text/front-matter">
  title: "Article Title"
  description: "Article description"
  authors:
  - Philipp Wacker:
  affiliations:
  - Friedrich-Alexander-Universität Erlangen-Nürnberg
</script>
<style>
    text {font-size: 8pt}
</style>
    <dt-article>
                  <h1>Simpson's paradox</h1>
                  <p>
                    We consider a set of 1440<dt-fn>Not, because this is one percent of the <a href=https://en.wikipedia.org/wiki/144,000>redeemed</a> but because it is a natural
                        number which is nicely divisible by a lot of other numbers: 1,2,3,4,5,6,8,9,10,12,15,16,18,20,24,30,32,36,40,45,48,60,72,80,90,96,120,144,160,180,240,288,360,480,720,1440.
                    </dt-fn> women and 1440 men and arrange them nicely in a rectangle 60 by 24, like so:
                  </p>
                  <svg id="figWhole" style="background: grey", style="stroke: black">
                  </svg>
                  <script>//
                        var graphicalDataW = {padding: 1, scale: scale, textPadding: 30, color: ["white", null, null, null], subdivideVert: false, subdivideHori: false, ratiosVert: false, ratiosHori: false};
                        var graphicalDataM = {padding: 1, scale: scale, textPadding: 30, color: ["white", null, null, null], subdivideVert: false, subdivideHori: false, ratiosVert: false, ratiosHori: false};
                        var paddingBlocks = 5 // padding between W and M block
                                                
                        buildFigure(d3.select("#figWhole"), dataW, dataM, graphicalDataW, graphicalDataM, paddingBlocks, paddingLeft)
                        
                        
                    </script>
                    <p>
                        Next, we group by faculty: applicants for math are colored yellow, applicants for literature are colored blue.
                    </p>
                    <svg id="figSepGender" onclick="clickFigSepGender()" style="background: grey">
                        </svg>
                        <script>//
                              var newColors = [d3.hcl(75, 80, 75), d3.hcl(75, 50, 85), d3.hcl(250, 80, 60), d3.hcl(250, 20, 70)];
                              var graphicalDataW = {padding: 1, scale: scale, textPadding: 30, color: ["white", "white", "white", "white"], subdivideVert: true, subdivideHori: false, ratiosVert: "left", ratiosHori: false};
                              var graphicalDataM = {padding: 1, scale: scale, textPadding: 30, color: ["white", "white", "white", "white"], subdivideVert: true, subdivideHori: false, ratiosVert: "right", ratiosHori: false};
                              var paddingBlocks = 5 // padding between W and M block

                                                      
                              buildFigure(d3.select("#figSepGender"), dataW, dataM, graphicalDataW, graphicalDataM, paddingBlocks, paddingLeft)
                            // initially, don't show blocks
                            d3.select("#figSepGender").select("#groupLeft").selectAll(".ratioBar").attr("opacity", 0.0)
                            d3.select("#figSepGender").select("#groupRight").selectAll(".ratioBar").attr("opacity", 0.0)                         
                              var clickFigSepGender = function()
                              {
                                d3.select("#figSepGender").select("#groupLeft").select("#ratioBarLeftTop").attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupLeft").select("#ratioBarLeftBottom").attr("fill", newColors[2])
                                d3.select("#figSepGender").select("#groupRight").select("#ratioBarRightTop").attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupRight").select("#ratioBarRightBottom").attr("fill", newColors[2])

                                d3.select("#figSepGender").select("#groupLeft").selectAll(".ratioBar").transition().duration(2000).ease(d3.easeLinear).attr("opacity", 1.0)
                                d3.select("#figSepGender").select("#groupRight").selectAll(".ratioBar").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("opacity", 1.0)

                                
                                

                                d3.select("#figSepGender").select("#groupLeft").select("#upperleft").select("#backgroundUL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupLeft").select("#upperright").select("#backgroundUR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupLeft").select("#lowerleft").select("#backgroundLL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])
                                d3.select("#figSepGender").select("#groupLeft").select("#lowerright").select("#backgroundLR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])

                                d3.select("#figSepGender").select("#groupRight").select("#upperleft").select("#backgroundUL").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupRight").select("#upperright").select("#backgroundUR").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figSepGender").select("#groupRight").select("#lowerleft").select("#backgroundLL").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])
                                d3.select("#figSepGender").select("#groupRight").select("#lowerright").select("#backgroundLR").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])


                              }

                          </script>
                    <p>Now we consider each of those four groups separately (i.e. women applying for math, men applying for literature etc.) and build more subgroups according to whether they get accepted or not</p>
                   
                    
                    
                    <svg onclick="clickFigAllCategories()" id="figAllCategories" style="background: grey">
                    </svg>
                    <script>//
                    var newColors = [d3.hcl(75, 80, 75), d3.hcl(75, 50, 85), d3.hcl(250, 80, 60), d3.hcl(250, 20, 70)];
                          var graphicalDataW = {padding: 1, scale: scale, textPadding: 30, color: [d3.hcl(75, 80, 75), d3.hcl(75, 80, 75), d3.hcl(250, 80, 60), d3.hcl(250, 80, 60)], subdivideVert: true, subdivideHori: true, ratiosVert: false, ratiosHori: true};
                          var graphicalDataM = {padding: 1, scale: scale, textPadding: 30, color: [d3.hcl(75, 80, 75), d3.hcl(75, 80, 75), d3.hcl(250, 80, 60), d3.hcl(250, 80, 60)], subdivideVert: true, subdivideHori: true, ratiosVert: false, ratiosHori: true};
                          var paddingBlocks = 5 // padding between W and M block
                                                  
                          buildFigure(d3.select("#figAllCategories"), dataW, dataM, graphicalDataW, graphicalDataM, paddingBlocks, paddingLeft)
                          
                          d3.select("#figAllCategories").select("#groupLeft").selectAll(".ratioBar").attr("opacity", 0.0)
                            d3.select("#figAllCategories").select("#groupRight").selectAll(".ratioBar").attr("opacity", 0.0)    
                            var clickFigAllCategories = function()
                              {
                                d3.select("#figAllCategories").select("#groupLeft").select("#ratioBarTopLeft").attr("fill", newColors[0])
                                d3.select("#figAllCategories").select("#groupLeft").select("#ratioBarBottomLeft").attr("fill", newColors[2])
                                d3.select("#figAllCategories").select("#groupLeft").select("#ratioBarTopRight").attr("fill", newColors[1])
                                d3.select("#figAllCategories").select("#groupLeft").select("#ratioBarBottomRight").attr("fill", newColors[3])
                                d3.select("#figAllCategories").select("#groupRight").select("#ratioBarTopLeft").style("fill", newColors[0])
                                d3.select("#figAllCategories").select("#groupRight").select("#ratioBarBottomLeft").attr("fill", newColors[2])
                                d3.select("#figAllCategories").select("#groupRight").select("#ratioBarTopRight").attr("fill", newColors[1])
                                d3.select("#figAllCategories").select("#groupRight").select("#ratioBarBottomRight").attr("fill", newColors[3])

                                d3.select("#figAllCategories").select("#groupLeft").selectAll(".ratioBar").transition().duration(2000).ease(d3.easeLinear).attr("opacity", 1.0)
                                d3.select("#figAllCategories").select("#groupRight").selectAll(".ratioBar").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("opacity", 1.0)

                                d3.select("#figAllCategories").select("#groupLeft").select("#upperleft").select("#backgroundUL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figAllCategories").select("#groupLeft").select("#upperright").select("#backgroundUR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[1])
                                d3.select("#figAllCategories").select("#groupLeft").select("#lowerleft").select("#backgroundLL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])
                                d3.select("#figAllCategories").select("#groupLeft").select("#lowerright").select("#backgroundLR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[3])

                                d3.select("#figAllCategories").select("#groupRight").select("#upperleft").select("#backgroundUL").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                d3.select("#figAllCategories").select("#groupRight").select("#upperright").select("#backgroundUR").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[1])
                                d3.select("#figAllCategories").select("#groupRight").select("#lowerleft").select("#backgroundLL").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])
                                d3.select("#figAllCategories").select("#groupRight").select("#lowerright").select("#backgroundLR").transition().delay(2000).duration(2000).ease(d3.easeLinear).attr("fill", newColors[3])


                              }
                      </script>

                    <!--<svg id="test" style="background: white"></svg>
                    <script>
                        var graphicalDataWTest = {padding: 1, scale: 7, textPadding: 30, color: [d3.hcl(75, 80, 75), d3.hcl(75, 50, 85), d3.hcl(250, 80, 60), d3.hcl(250, 20, 70)], subdivideVert: true, subdivideHori: true, ratiosVert: false, ratiosHori: false};
                        var graphicalDataMTest = {padding: 1, scale: 3, textPadding: 30, color: [d3.hcl(75, 80, 75), d3.hcl(75, 50, 85), d3.hcl(250, 80, 60), d3.hcl(250, 20, 70)], subdivideVert: true, subdivideHori: true, ratiosVert: false, ratiosHori: false};
                        var paddingBlocksTest = 5 // padding between W and M block
                        buildFigure(d3.select("#test"), dataWTest, dataMTest, graphicalDataWTest, graphicalDataMTest, paddingBlocksTest, paddingLeft)
                    </script>-->




                  
                  

</dt-article>
