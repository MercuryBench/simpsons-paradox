<!DOCTYPE html>
<meta charset="utf-8">
<script src="https://distill.pub/template.v1.js"></script>
<script src="https://d3js.org/d3.v5.js"></script>
<script src="buildFigure.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

    <script>    
    var dataA = {Nx: 60, Ny: 24, Nx11: 54, Nx12: 6, Nx21: 42, Nx22: 18, Ny1: 8, Ny2: 16};
                        var dataB = {Nx: 60, Ny: 24, Nx11: 51, Nx12: 9, Nx21: 39, Nx22: 21, Ny1: 20, Ny2: 4};
                        var scale = 8
                        var paddingBar = 50
                        var paddingBlocks = 5 // padding between W and M block
    </script>

<script type="text/front-matter">
  title: "Article Title"
  description: "Article description"
  authors:
  - Philipp Wacker:
  affiliations:
  - Friedrich-Alexander-Universität Erlangen-Nürnberg
</script>
<style>
    text {font-size: 8pt}
    div.tooltip {	
    position: absolute;			
    text-align: center;			
    width: 60px;					
    height: 28px;					
    padding: 2px;				
    font: 12px sans-serif;		
    background: lightsteelblue;	
    border: 0px;		
    border-radius: 8px;			
    pointer-events: none;	}
</style>
    <dt-article><p>
                        <em>Click anywhere on the figure to group by kidney stone size.</em> We use yellow for patients with <span style="background-color: rgb(243, 169, 6)">small</span> kidney stones and 
                        blue for <span style="background-color: rgb(0, 163, 255)">large</span> ones.
                        </p>
                        
                        <p>
                        
                    </p>
                    <svg id="figSepGender" onclick="clickFigSepGender()" style="background: grey">
                        </svg>
                        <div id="divHidden" style= "visibility: hidden">
                        <ul>
                            <li id="item1" onmouseover="mouseover1()" onmouseleave="mouseleave1()">Among patients treated with treatment A, there were more patients with <span style="background-color: rgb(0, 163, 255)">large</span> 
                              kidney stones than those with <span style="background-color: rgb(243, 169, 6)">small</span> kidney stones </li>
                            <li id="item2"  onmouseover="mouseover2()" onmouseleave="mouseleave2()">Among patients treated with treatment B, there were more patients with <span style="background-color: rgb(243, 169, 6)">small</span> kidney stones 
                              than those with <span style="background-color: rgb(0, 163, 255)">small</span> kidney stones</span></li>
                          </ul></div>
                        <script>
                          var mouseover1 = function()
                            {
                                var svg = d3.select("#figSepGender")
                                console.log("1")
                                svg.select("#groupRight").attr("opacity", 0.35)                
                                document.getElementById("item1").style = "background-color: green"
                            }
                            var mouseleave1 = function()
                            {
                                var svg = d3.select("#figSepGender")
                                svg.select("#groupRight").attr("opacity", 1)                              
                                document.getElementById("item1").style = "background-color: white"
                            }
                            var mouseover2 = function()
                            {
                                var svg = d3.select("#figSepGender")
                                svg.select("#groupLeft").attr("opacity", 0.35)                
                                document.getElementById("item1").style = "background-color: green"
                            }
                            var mouseleave2 = function()
                            {
                                var svg = d3.select("#figSepGender")
                                svg.select("#groupLeft").attr("opacity", 1)                              
                                document.getElementById("item1").style = "background-color: white"
                            }
                            </script>

                        <script>//
                              var newColors = [d3.hcl(75, 80, 75), d3.hcl(75, 50, 85), d3.hcl(250, 80, 60), d3.hcl(250, 20, 70)];
                              var labelAUpper = dataA.Nx + " * " + dataA.Ny1 + " = " + dataA.Nx*dataA.Ny1 + " patients with small kidney stones were treated with treatment A";
                              var labelBUpper = dataB.Nx + " * " + dataB.Ny1 + " = " + dataB.Nx*dataB.Ny1 + " patients with small kidney stones were treated with treatment B";
                              var labelALower = dataA.Nx + " * " + dataA.Ny2 + " = " + dataA.Nx*dataA.Ny2 + " patients with large kidney stones were treated with treatment A";
                              var labelBLower = dataB.Nx + " * " + dataB.Ny2 + " = " + dataB.Nx*dataB.Ny2 + " patients with large kidney stones were treated with treatment B";
                              var labelDataA = {labelUpper: ["small stones", "hidden"], labelLower: ["large stones", "hidden"], labelUpperLeft: [labelAUpper, "hidden"], labelUpperRight: [labelAUpper, "hidden"], labelLowerLeft: [labelALower, "hidden"], labelLowerRight: [labelALower, "hidden"], labelRatioBarSideTop: "Ratio of patients under treatment A with small kidney stones", labelRatioBarSideBottom: "Ratio of patients under treatment A with large kidney stones"};
                              var labelDataB = {labelUpper: ["small stones", "hidden"], labelLower: ["large stones", "hidden"], labelUpperLeft: [labelBUpper, "hidden"], labelUpperRight: [labelBUpper, "hidden"], labelLowerLeft: [labelBLower, "hidden"], labelLowerRight: [labelBLower, "hidden"], labelRatioBarSideTop: "Ratio of patients under treatment B with small kidney stones", labelRatioBarSideBottom: "Ratio of patients under treatment B with large kidney stones"};
                              var graphicalDataA = {padding: 1, scale: scale, textPadding: 30, color: ["white", "white", "white", "white"], subdivideVert: false, subdivideHori: false, paddingBlocks : 5, paddingBar: 50, widthBar: 25, titleLeft: "Treatment A", titleRight: "Treatment B", titlePadding: 50, labelData: labelDataA};
                              var graphicalDataB = {padding: 1, scale: scale, textPadding: 30, color: ["white", "white", "white", "white"], subdivideVert: false, subdivideHori: false, paddingBlocks : 5, paddingBar: 50, widthBar: 25, titleLeft: "Treatment A", titleRight: "Treatment B", titlePadding: 50, labelData: labelDataB};

                                    
                              buildFigure(d3.select("#figSepGender"), dataA, dataB, graphicalDataA, graphicalDataB, paddingBlocks, paddingBar)

                              var clickFigSepGender = function()
                              {
                                var groupLeft = d3.select("#figSepGender").select("#groupLeft");
                                var groupRight = d3.select("#figSepGender").select("#groupRight");
                                for (var g of [groupLeft, groupRight])
                                {
                                  g.select("#ratioBarSideTop").attr("fill", newColors[0])
                                  g.select("#ratioBarSideBottom").attr("fill", newColors[2])
                                
                                
                                g.selectAll(".labelNy_sub").attr("visibility", "visible")
                                g.select("#labelNy").attr("visibility", "hidden")

                                g.selectAll(".ratioBarSide").attr("opacity", 0.0)   
                                g.selectAll(".ratioBarSide").attr("visibility", "visible") 

                                g.selectAll(".ratioBarSide").transition().duration(2000).ease(d3.easeLinear).attr("opacity", 1.0)                                
                                

                                g.select("#upperleft").select("#backgroundUL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                g.select("#upperright").select("#backgroundUR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[0])
                                g.select("#lowerleft").select("#backgroundLL").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])
                                g.select("#lowerright").select("#backgroundLR").transition().duration(2000).ease(d3.easeLinear).attr("fill", newColors[2])

                                // make group labels visible (i.e. "small stones" and "large stones")
                                g.select("#upperleft").select("text").attr("visibility", "visible")
                                g.select("#lowerleft").select("text").attr("visibility", "visible")

                                // make next paragraph visible
                                d3.select("#divHidden").style("visibility", "visible")
                                }


                              }
                          
                          </script>
                    
                      </dt-article>